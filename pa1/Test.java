import edu.princeton.cs.algs4.*;

class Test {
    // Tests 30 precomputed 2-3-trees, and does a few hundred random insertion/deletions.
    static public void main(String[] args) {
      TwoThreeTree<Integer> tree = new TwoThreeTree<Integer>();

      String[][] testSuite = {{"+4", "+6", "+7", "+9", "+13", "+15", "+16", "+8", "-9",
                               "8 -- {6 -- {4, 7}, 15 -- {13, 16}}", "7"},
                              {"-10", "-12", "-1", "+13", "-15", "+26", "-22", "+15", "+18", "+11", "+7", "-22", "-27", "+28", "+23", "+20", "+5", "+19", "-13", "+14", "-26", "+19", "+27", "-8", "+6", "-29", "-10", "+13", "-18", "-10", "-18", "+10", "-8", "+26", "-27", "-6", "+11", "+18", "-26", "+19", "-23", "-20", "+24", "+5", "+20", "+20", "+21", "-3", "+24", "+25", 
                               "11 18 -- {7 -- {5, 10}, 14 -- {13, 15}, 20 24 -- {19, 21, 25 28}}", "14"},
                              {"-14", "-1", "-8", "+2", "-19", "+3", "-22", "-12", "+24", "-11", "-28", "+3", "+2", "-13", "+22", "-3", "-20", "-16", "+23", "-14", "+14", "-22", "+18", "+14", "+20", "+24", "-14", "+28", "+12", "+26", "+6", "-7", "-24", "-26", "+8", "+4", "+17", "+26", "+6", "-11", "+16", "-9", "+17", "+4", "-14", "-14", "+16", "+29", "+25", "-20", 
                               "18 -- {4 12 -- {2, 6 8, 16 17}, 25 28 -- {23, 26, 29}}", "13"},
                              {"-8", "-16", "-5", "+12", "+1", "+24", "+8", "+24", "-29", "-3", "-23", "-14", "+3", "+1", "-6", "+24", "+27", "+24", "+24", "+1", "+2", "-1", "+11", "-8", "+12", "+23", "-14", "+10", "+26", "-28", "-6", "+2", "+9", "-9", "+24", "-22", "+14", "+4", "-14", "+10", "+4", "-27", "-16", "+1", "+18", "-4", "+3", "+8", "+25", "-17", 
                               "10 -- {2 -- {1, 3 8}, 12 24 -- {11, 18 23, 25 26}}", "12"},
                              {"+2", "+28", "+1", "-1", "+25", "-25", "+9", "-22", "-2", "-8", "+2", "+14", "-11", "+14", "-22", "-20", "-3", "-10", "-8", "+6", "-6", "+21", "-23", "+20", "-29", "-16", "-22", "-18", "-1", "-18", "+1", "-14", "-6", "+10", "+16", "+11", "+26", "+7", "+27", "+15", "-28", "+26", "+8", "-3", "-16", "+4", "-17", "+12", "+5", "-18", 
                               "7 20 -- {2 -- {1, 4 5}, 9 11 -- {8, 10, 12 15}, 26 -- {21, 27}}", "15"},
                              {"-15", "-15", "+2", "+13", "+5", "-16", "+14", "+4", "-3", "-14", "+15", "+6", "+12", "+12", "-26", "-3", "+20", "-27", "-14", "-18", "+5", "-9", "-10", "+14", "+2", "+16", "-3", "-26", "+15", "+1", "-11", "-26", "+18", "-4", "+1", "-13", "-26", "+12", "+7", "-2", "-19", "-3", "+13", "+21", "+15", "+3", "-7", "-20", "-21", "-7", 
                               "6 -- {3 -- {1, 5}, 13 15 -- {12, 14, 16 18}}", "10"},
                              {"-6", "+1", "+2", "-12", "+19", "-2", "-2", "+26", "-8", "+12", "+23", "-4", "-26", "-12", "+1", "+8", "+3", "-8", "+6", "+11", "-29", "+26", "-4", "+12", "+1", "+1", "-1", "+15", "-16", "+2", "+19", "+29", "-4", "-21", "+8", "-6", "+1", "-18", "+22", "-21", "+25", "-8", "+18", "+14", "+7", "-24", "-25", "+29", "-27", "+6", 
                               "11 22 -- {2 6 -- {1, 3, 7}, 15 -- {12 14, 18 19}, 26 -- {23, 29}}", "15"},
                              {"-2", "-19", "-16", "+22", "+1", "+22", "+8", "-23", "-19", "+21", "+28", "+6", "+1", "-24", "-7", "-7", "-21", "-9", "-3", "+5", "+24", "-10", "-21", "-5", "+29", "-1", "+6", "+1", "-15", "-19", "+14", "-10", "+12", "-26", "+14", "+11", "+28", "+10", "+19", "+1", "+18", "+9", "-27", "-25", "+19", "+25", "-5", "+20", "+10", "-25", 
                               "12 22 -- {8 10 -- {1 6, 9, 11}, 18 -- {14, 19 20}, 28 -- {24, 29}}", "15"},
                              {"-20", "+29", "-5", "+28", "-17", "-1", "-8", "-14", "+8", "-13", "-11", "-2", "+23", "-28", "-1", "+5", "+26", "+11", "-10", "+10", "+23", "-24", "+11", "-10", "+4", "+26", "-26", "-15", "-26", "+18", "+21", "-15", "-6", "+22", "-14", "-19", "-20", "+8", "+28", "-28", "-12", "-7", "+14", "+14", "-12", "+9", "-6", "+10", "-26", "-8", 
                               "18 -- {5 11 -- {4, 9 10, 14}, 22 -- {21, 23 29}}", "11"},
                              {"+11", "+28", "-3", "-3", "-7", "+20", "-1", "+13", "+23", "+29", "+9", "-14", "-22", "+23", "+20", "-19", "+18", "-21", "+10", "-23", "-4", "+12", "-19", "+11", "-4", "-26", "-9", "-8", "-10", "+2", "-12", "-22", "-8", "-16", "+17", "+4", "-3", "-1", "-9", "+4", "-11", "+3", "+1", "+20", "+7", "+1", "-2", "+18", "+17", "+23", 
                               "18 -- {3 13 -- {1, 4 7, 17}, 28 -- {20 23, 29}}", "11"},
                              {"+21", "-6", "-10", "-26", "-21", "-24", "-19", "-3", "+9", "-1", "+18", "-1", "-23", "-22", "+5", "-28", "+6", "-8", "-1", "-1", "+29", "-3", "-16", "+21", "+26", "-19", "-17", "-21", "+6", "-13", "+2", "-26", "+10", "-2", "+1", "+10", "+24", "-20", "-23", "-29", "+28", "-17", "-16", "-27", "+10", "-20", "+21", "+15", "-22", "-13", 
                               "10 -- {6 -- {1 5, 9}, 18 24 -- {15, 21, 28}}", "10"},
                              {"+26", "-22", "-19", "+7", "+17", "-19", "-18", "+1", "-15", "+15", "-7", "-27", "-3", "+21", "-28", "-1", "+15", "+4", "+5", "+11", "+22", "+14", "+28", "-19", "-27", "-27", "-7", "-15", "-20", "-9", "+14", "-5", "-1", "-9", "+8", "+7", "+24", "-1", "-19", "-1", "-18", "-14", "-10", "+1", "-21", "-21", "+28", "+20", "-6", "-1", 
                               "22 -- {7 11 -- {4, 8, 17 20}, 26 -- {24, 28}}", "10"},
                              {"+24", "-24", "-15", "-26", "+28", "-28", "-2", "-15", "-28", "-1", "+22", "+7", "-20", "+23", "-4", "+16", "+29", "+29", "-10", "-14", "-17", "-7", "+1", "-6", "-15", "-1", "+17", "-8", "+6", "-8", "+20", "+9", "+29", "+13", "+20", "+1", "+6", "+12", "+28", "-28", "+29", "-24", "-1", "-7", "+12", "-13", "-16", "-25", "-15", "-11", 
                               "17 -- {9 -- {6, 12}, 22 -- {20, 23 29}}", "8"},
                              {"+21", "+29", "+29", "+3", "-5", "-29", "+29", "-23", "-19", "-28", "+19", "-11", "-2", "+1", "-1", "+17", "-2", "-7", "-7", "-5", "+9", "+4", "-16", "+19", "+23", "+10", "+4", "-14", "+1", "+13", "-29", "-25", "+13", "-9", "+27", "-24", "-11", "-29", "-1", "+19", "+26", "-11", "+27", "-8", "-25", "+4", "-2", "+13", "+13", "+24", 
                               "21 -- {10 17 -- {3 4, 13, 19}, 26 -- {23 24, 27}}", "11"},
                              {"+12", "-26", "+25", "+29", "+6", "-13", "-1", "+1", "-12", "+13", "+20", "+16", "-14", "-5", "+24", "+5", "-20", "-20", "+13", "-8", "+21", "-26", "+26", "-22", "-1", "-2", "+12", "-19", "+14", "+9", "-29", "-23", "+19", "+23", "-14", "-12", "+17", "+15", "-11", "-3", "-11", "-7", "+5", "-13", "-26", "+29", "+14", "-5", "-15", "-5", 
                               "21 -- {9 16 -- {6, 14, 17 19}, 24 -- {23, 25 29}}", "11"},
                              {"+11", "-8", "-9", "-20", "-14", "+21", "+2", "-25", "-23", "+21", "-16", "+22", "+3", "+13", "-1", "+24", "-7", "-19", "+25", "+20", "-11", "+6", "-20", "+13", "-22", "+24", "+6", "+15", "+1", "+4", "-3", "-3", "+2", "-16", "-3", "-9", "+14", "-21", "-26", "+22", "+7", "+27", "-11", "-19", "-4", "+7", "-17", "-28", "+24", "+8", 
                               "13 -- {6 -- {1 2, 7 8}, 15 24 -- {14, 22, 25 27}}", "12"},
                              {"-17", "+15", "+12", "+16", "+28", "-4", "+21", "+17", "+19", "+5", "-25", "-8", "-11", "+24", "-28", "-7", "+3", "+11", "+8", "-1", "+14", "-10", "+1", "+9", "+8", "+16", "+27", "+2", "+23", "-5", "+6", "+14", "+7", "+11", "+8", "-14", "+12", "-15", "+2", "+14", "-27", "+11", "+18", "-7", "-3", "-6", "-16", "-3", "-15", "+24", 
                               "11 19 -- {2 -- {1, 8 9}, 17 -- {12 14, 18}, 23 -- {21, 24}}", "13"},
                              {"-14", "+26", "-2", "+15", "+29", "-19", "+17", "-18", "-9", "-12", "+10", "+20", "-12", "-4", "+2", "+19", "+26", "+9", "-23", "-16", "-9", "-25", "+1", "-26", "+28", "-9", "-15", "+3", "+7", "-19", "-17", "+7", "+20", "-26", "+13", "-24", "-2", "-14", "+5", "-29", "-3", "-13", "-22", "+3", "+4", "-28", "-12", "+25", "+24", "-22", 
                               "5 -- {3 -- {1, 4}, 10 24 -- {7, 20, 25}}", "9"},
                              {"-18", "+17", "-29", "+1", "-29", "+26", "+4", "+18", "-1", "-6", "+27", "+10", "+2", "-27", "+27", "+22", "+20", "+15", "-7", "-10", "+9", "-22", "+18", "-5", "+1", "-18", "-9", "-21", "+21", "+26", "-3", "-23", "-7", "+5", "+8", "-7", "+10", "+6", "-26", "-5", "-27", "-12", "+16", "+23", "-4", "-1", "-16", "+25", "-27", "+24", 
                               "15 -- {8 -- {2 6, 10}, 20 23 -- {17, 21, 24 25}}", "11"},
                              {"+28", "-29", "+2", "-4", "-5", "-23", "-6", "+1", "+27", "-9", "-27", "-1", "+23", "-2", "-7", "+13", "+26", "+6", "+1", "-11", "-19", "+5", "-25", "+25", "+28", "+24", "+23", "-27", "-22", "-5", "-26", "-1", "+28", "-9", "-7", "+25", "+28", "-15", "+9", "+3", "+14", "+2", "+8", "+7", "-18", "+29", "+3", "+3", "+11", "+23", 
                               "7 23 -- {3 -- {2, 6}, 9 13 -- {8, 11, 14}, 25 -- {24, 28 29}}", "14"},
                              {"+22", "-26", "-21", "-2", "-18", "+3", "-9", "+19", "-18", "-26", "+7", "-14", "+16", "-17", "-21", "-25", "-23", "-28", "+17", "-29", "+20", "+16", "+24", "+23", "-26", "+8", "-20", "-22", "-1", "+20", "-5", "+14", "+26", "+8", "+13", "+22", "+25", "-9", "+1", "-4", "+13", "+25", "-28", "-15", "+28", "+11", "-10", "-18", "-17", "+6", 
                               "13 23 -- {3 7 -- {1, 6, 8 11}, 16 20 -- {14, 19, 22}, 25 -- {24, 26 28}}", "17"},
                              {"+22", "+10", "+24", "-8", "+22", "-23", "+15", "+23", "+4", "-19", "-14", "+21", "+28", "+13", "+29", "+10", "+8", "-17", "-18", "-13", "+5", "-25", "+1", "+2", "+18", "+4", "+17", "+24", "+2", "-11", "-1", "+7", "-29", "-12", "-29", "+14", "-17", "+9", "-1", "-17", "+22", "-5", "-23", "+23", "-12", "-21", "-15", "+7", "+5", "-25", 
                               "8 18 -- {4 -- {2, 5 7}, 10 -- {9, 14}, 23 -- {22, 24 28}}", "13"},
                              {"+1", "-9", "+8", "-6", "-21", "+18", "+15", "-16", "-10", "+1", "-28", "+28", "+25", "+17", "+2", "+23", "+25", "+27", "-28", "-17", "+9", "-18", "-19", "+5", "+26", "+24", "-26", "-7", "+15", "-19", "+10", "+16", "-28", "-22", "+28", "+19", "-27", "+7", "-1", "+7", "+27", "-28", "-17", "+3", "-16", "-24", "+2", "-1", "-6", "+26", 
                               "8 19 -- {3 -- {2, 5 7}, 10 -- {9, 15}, 25 -- {23, 26 27}}", "13"},
                              {"-9", "+26", "-19", "-11", "-28", "+1", "+29", "+1", "+2", "+7", "-5", "+29", "-27", "-25", "+21", "-26", "-14", "+24", "+1", "+24", "-9", "+13", "+19", "-16", "-18", "+27", "-4", "+28", "-18", "-27", "-15", "-16", "+22", "+22", "-18", "-24", "-11", "+20", "-5", "-12", "-18", "-5", "-17", "-15", "-15", "+2", "+20", "-6", "-18", "+24", 
                               "21 -- {2 19 -- {1, 7 13, 20}, 28 -- {22 24, 29}}", "11"},
                              {"-27", "+8", "-5", "+1", "-2", "+27", "+17", "-23", "-27", "+8", "+22", "+12", "-20", "+1", "+16", "+7", "-17", "+20", "+1", "-2", "-4", "+16", "-22", "+29", "+9", "-13", "+1", "+29", "-27", "-20", "+1", "-2", "+20", "+26", "+10", "+26", "-18", "-15", "+13", "+22", "+27", "+25", "+17", "-27", "+19", "+12", "+24", "-26", "-14", "+16", 
                               "10 22 -- {8 -- {1 7, 9}, 16 19 -- {12 13, 17, 20}, 25 -- {24, 29}}", "15"},
                              {"+23", "-28", "+21", "-1", "-2", "+6", "-1", "-8", "+7", "-21", "-26", "+1", "+7", "+25", "-5", "-10", "+12", "+24", "-7", "+7", "-6", "-13", "+22", "-7", "-26", "-16", "-1", "+8", "-7", "-1", "+9", "+1", "-10", "-9", "-18", "+10", "-1", "-7", "-13", "-21", "-10", "-6", "-2", "-22", "+1", "+3", "+24", "+1", "-13", "-28", 
                               "12 -- {3 -- {1, 8}, 24 -- {23, 25}}", "7"},
                              {"-3", "-19", "+24", "-13", "-4", "+4", "+25", "+1", "+24", "-14", "+20", "-28", "-28", "-28", "+15", "-13", "+4", "+10", "-23", "-10", "+15", "+29", "-24", "-5", "-19", "+11", "-7", "-25", "-2", "+27", "+15", "-21", "+6", "-2", "+13", "+10", "+18", "-4", "-18", "-3", "-1", "-14", "+23", "-24", "-23", "-14", "+3", "-29", "+20", "-5", 
                               "10 15 -- {3 6, 11 13, 20 27}", "8"},
                              {"+19", "-27", "-13", "-28", "-27", "-10", "-3", "+18", "+8", "-5", "-10", "-4", "+15", "+3", "+2", "-23", "+13", "-24", "+5", "+4", "-28", "+15", "+12", "+12", "+23", "+6", "+8", "+6", "+15", "-8", "-15", "+15", "-25", "-16", "-7", "+8", "-11", "-17", "-1", "+12", "-1", "-15", "-10", "+22", "+21", "+25", "-12", "-4", "+27", "-29", 
                               "19 -- {3 8 -- {2, 5 6, 13 18}, 22 25 -- {21, 23, 27}}", "13"},
                              {"-29", "-10", "-1", "+8", "+28", "-12", "-29", "-29", "-20", "+17", "+7", "+12", "-13", "+22", "+6", "+10", "-9", "+17", "+5", "+1", "-16", "-7", "-5", "-20", "+1", "+1", "+13", "+10", "-21", "+24", "+10", "+11", "-27", "-16", "+28", "-22", "-17", "+17", "-16", "+14", "-19", "+18", "-26", "+10", "-9", "-1", "+24", "-25", "+7", "+16", 
                               "12 -- {7 10 -- {6, 8, 11}, 14 18 -- {13, 16 17, 24 28}}", "13"},
                              {"-1", "+9", "-4", "-5", "-6", "-4", "-1", "+23", "+22", "+6", "+28", "-23", "+6", "-5", "+9", "-4", "+13", "+25", "+1", "+7", "-2", "+23", "+2", "+13", "+10", "+4", "-27", "-15", "-16", "-11", "-8", "+3", "+1", "-19", "-9", "+3", "+25", "-4", "+14", "+7", "-1", "-1", "-8", "-21", "+23", "-10", "-18", "+13", "+16", "-4", 
                               "22 -- {6 13 -- {2 3, 7, 14 16}, 25 -- {23, 28}}", "11"},
                              {"-6", "+3", "+8", "+23", "+13", "+9", "+29", "-3", "-11", "+18", "+25", "-5", "-5", "-21", "+15", "-2", "+4", "+23", "+20", "-23", "-15", "+11", "-23", "+24", "-16", "+27", "+19", "-26", "-29", "+21", "+6", "-3", "-1", "+9", "-19", "-10", "-22", "-22", "-24", "-28", "+1", "-26", "-12", "-12", "-22", "-7", "-17", "-14", "+29", "-3", 
                               "13 -- {6 9 -- {1 4, 8, 11}, 20 25 -- {18, 21, 27 29}}", "13"}};

      
      for (int i = 0; i < testSuite.length; ++i) {
        tree = new TwoThreeTree<Integer> ();
        for (int j = 0; j < testSuite[i].length - 2; ++j) {
          int n = Integer.parseInt (testSuite[i][j]);
          if (n >= 0) {
            tree.put (n);
            assert tree.contains (n);
          } else {
            tree.delete (-n);
            assert !tree.contains (-n);
          }
        }
        assert !tree.contains (-10);
        assert !tree.contains (1 << 30);
        assert tree.size() == Integer.parseInt (testSuite[i][testSuite[i].length - 1]);
        if (testSuite[i][testSuite[i].length - 2].equals (tree.toString ()))
          StdOut.println ("PASSED TEST " + i);
        else {
          StdOut.println ("FAILED TEST " + i + ": ");
          StdOut.println ("  expected: " + testSuite[i][testSuite[i].length - 2]);
          StdOut.println ("  produced: " + tree);
        }
      }
        
      for (int j = 0; j < 300; ++j) {
        tree = new TwoThreeTree<Integer> ();
        for (int i = 0; i < 200; ++i) {
          assert tree.is23 ();
          int n = (int) (Math.random() * 30);
          if (Math.random() > 0.5) {
            tree.put (n);
            assert tree.contains (n);
          } else {
            tree.delete (n);
            assert !tree.contains (-n);
          }
        }
      }
    }
}
